<!doctype html> 
<html lang="en"> 

<head> 
	<meta charset="UTF-8" />
  <title>Canvas Test</title>
  <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
</head>

<body>
  <noscript><h1>This is a JS Game, please enable JS</noscript>
  webgl:
  <div id="webgl"></div>
  canvas:
  <div id="canvas"></div>

  <script type="text/javascript">

    /* Both games (webgl and canvas) check the global val variable for the rotation */
    var val = 0;
    setInterval(function() {
      val += .01;
    }, 50);

    /* Setting up theGame state */
    var theGame = function(game) { }

    theGame.prototype = { 
      preload: function() {
        this.game.load.image('injector', 'injector.png');
      },

      create: function() {
        this.game.stage.backgroundColor = "#ADD";
        this.game.physics.startSystem(Phaser.Physics.ARCADE);

        this.injector = this.game.add.sprite(0,0, 'injector');
        this.injector.anchor.setTo(0.0, 0.7);
        this.aim_ring = new Phaser.Circle(this.game.world.centerX, this.game.world.centerY, this.game.stage.height);
      },

      update: function() {
        this.point = Phaser.Circle.circumferencePoint(this.aim_ring, val);
        this.injector.x = this.point.x;
        this.injector.y = this.point.y;
        this.injector.rotation = this.game.physics.arcade.angleBetween(this.injector, this.aim_ring) + 1.5;
      },

      render: function() {
        this.game.debug.spriteInfo(this.injector, 100, 100);
      }
    };

    /*
    We're just  creating and starting the 2 games with 2 seperate renderers
    */
    var games = ['webgl', 'canvas'];
    var renderer;
    games = games.map(function(game){
      if (game === 'webgl') {
        renderer = Phaser.WEBGL;
      } else {
        renderer = Phaser.CANVAS;
      }
      var ourGame = new Phaser.Game(500, 400, renderer, game);
      return ourGame;
    });

    games[0].state.add("TheGame", theGame);
    games[0].state.start("TheGame");

    games[1].state.add("TheGame", theGame);
    games[1].state.start("TheGame");
  </script>
</body>

</html>
